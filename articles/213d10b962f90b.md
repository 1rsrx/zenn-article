---
title: "Main.storyboardã®å‰Šé™¤ä½œæ¥­ã‚’è‡ªå‹•åŒ–ã™ã‚‹"
emoji: "ğŸ¾"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["swift", "shell"]
published: true
publication_name: "karabiner_inc"
---

# ã¯ã˜ã‚ã«
Main.storyboardã®å‰Šé™¤ä½œæ¥­ã‚’ã‚·ã‚§ãƒ«ã§è‡ªå‹•åŒ–ã—ã¦ã¿ã¾ã—ãŸã€‚

(è£œè¶³)
ã‹ãªã‚Šç„¡ç†ã‚„ã‚Šãªå®Ÿè£…ã‚’ã—ã¦ã„ã‚‹ç®‡æ‰€ãŒã‚ã‚Šã¾ã™ã€‚
æœ€å¾Œã®æ³¨æ„äº‹é …ã‚’èª­ã‚“ã§ã‹ã‚‰å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

# å®Ÿè£…æ–¹é‡
- Main.storyboardã‚’å‰Šé™¤
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã€Xcodeã‹ã‚‰ã®å‚ç…§ã‚’æ¶ˆã™
- Info.plistã‚’ä¿®æ­£ã™ã‚‹
- SceneDelegateã§åˆæœŸç”»é¢ã‚’è¨­å®šã™ã‚‹

# å®Ÿè£…
```shell
#!/bin/bash

# Main.storyboardã‚’å‰Šé™¤
current_dir=$(basename "$(pwd)")
cd $current_dir/Base.lproj
rm Main.storyboard

# Info.plistã®ä¿®æ­£
cd ../
sed -i '' '/<key>UISceneStoryboardFile<\/key>/d' Info.plist
sed -i '' '/<string>Main<\/string>/d' Info.plist

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿®æ­£
cd ../
cd $current_dir.xcodeproj

projfile="project.pbxproj"
start_pattern="\/\* Main\.storyboard \*\/ = {"
start=$(grep -n "$start_pattern" "$projfile" | cut -d ":" -f1)
sed -i '' "${start},/};/d" $projfile

sed -i '' "/Main.storyboard/d" $projfile

sed -i '' '/INFOPLIST_KEY_UIMainStoryboardFile = Main;/d' $projfile

# SceneDelegate.swiftã«åˆæœŸç”»é¢ã‚’è¨­å®šã™ã‚‹
cd ../
cd $current_dir

target="guard let scene = (scene as? UIWindowScene) else { return }\n\t\tlet window = UIWindow(windowScene: scene)\n\t\twindow.rootViewController = ViewController()\n\t\twindow.makeKeyAndVisible()\n\t\tself.window = window"
sed -i "" "s/guard let _ = (scene as? UIWindowScene) else { return }/${target}/" "SceneDelegate.swift"
```

### Main.storyboardã®å‰Šé™¤
ã“ã‚Œã¯ç°¡å˜ã§`rm`ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã ã‘ã§ã™ã€‚
```shell
rm Main.storyboard
```

### Info.plistã®ä¿®æ­£
Info.plistã‹ã‚‰`<key>UISceneStoryboardFile</key>`ã¨`<string>Main</string>`ã‚’å‰Šé™¤ã—ã¦ã„ã¾ã™ã€‚
```shell
sed -i '' '/<key>UISceneStoryboardFile<\/key>/d' Info.plist
sed -i '' '/<string>Main<\/string>/d' Info.plist
```

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿®æ­£
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å†…ã«ä¸‹è¨˜ã®ã‚ˆã†ãªãƒ–ãƒ­ãƒƒã‚¯ãŒã‚ã‚Šã€
`/* Main.storyboard */ = {`ã‚’å«ã‚€è¡Œã‹ã‚‰`};`ã¾ã§ã‚’å‰Šé™¤ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚
```
C663F1DB2A2061800010DCF8 /* Main.storyboard */ = {
    isa = PBXVariantGroup;
    children = (
        C663F1DC2A2061800010DCF8 /* Base */,
    );
    name = Main.storyboard;
    sourceTree = "<group>";
};
```

```shell
projfile="project.pbxproj"
start_pattern="\/\* Main\.storyboard \*\/ = {"
start=$(grep -n "$start_pattern" "$projfile" | cut -d ":" -f1)
sed -i '' "${start},/};/d" $projfile
```

ä»–ã«ã‚‚Main.storyboardé–¢é€£ã®è¡ŒãŒã‚ã‚‹ã®ã§ã€å‰Šé™¤ã—ã¾ã™ã€‚
```shell
sed -i '' "/Main.storyboard/d" $projfile
sed -i '' '/INFOPLIST_KEY_UIMainStoryboardFile = Main;/d' $projfile
```

### åˆæœŸç”»é¢ã®è¨­å®š
ScheneDelegateã«`guard let _ = (scene as? UIWindowScene) else { return }`ãŒã‚ã‚‹ã®ã§ãã‚Œã‚’åˆæœŸç”»é¢ã‚’è¨­å®šã™ã‚‹ã‚³ãƒ¼ãƒ‰ã«ç½®æ›ã—ã¾ã™ã€‚
```shell
target="guard let scene = (scene as? UIWindowScene) else { return }\n\t\tlet window = UIWindow(windowScene: scene)\n\t\twindow.rootViewController = ViewController()\n\t\twindow.makeKeyAndVisible()\n\t\tself.window = window"
sed -i "" "s/guard let _ = (scene as? UIWindowScene) else { return }/${target}/" "SceneDelegate.swift"
```
(ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’æƒãˆã‚‹ãŸã‚ã«ã‚¿ãƒ–ã‚’2å›æŒ¿å…¥ã—ã¦ã„ã¾ã™ãŒã€äººã«ã‚ˆã£ã¦ã¯1å›ã§ã„ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚)

# å®Ÿè¡Œæ–¹æ³•
- ã‚·ã‚§ãƒ«ã‚’ã©ã“ã‹ã«ä¿å­˜
  - ä¾‹: ~/Shell/kill_main_sb.sh
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
- `sh ~/Shell/kill_main_sb.sh`

[ã“ã®ã‚ãŸã‚Š](https://ywatanabevltmathscilogic.hatenablog.com/entry/2021/05/29/032844)ã‚’å‚è€ƒã«ã€ã‚³ãƒãƒ³ãƒ‰åŒ–ã•ã›ã¦ãŠãã¨ä¾¿åˆ©ã§ã™ã€‚

### æ³¨æ„ç‚¹
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ãŸç›´å¾Œã«å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚
- Xcodeã§è‰²ã€…æ“ä½œã—ãŸå¾Œã ã¨ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®æ“ä½œã§å¤±æ•—ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
- Xcodeãƒãƒ¼ã‚¸ãƒ§ãƒ³å¤‰æ›´ã«ã‚ˆã£ã¦ã€ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã¯å‹•ã‹ãªããªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
  - 14.2, 14.3ã§ã¯å‹•ãã¾ã—ãŸã€‚

# æœ€å¾Œã«
ChatGPTã«å”åŠ›ã—ã¦ã‚‚ã‚‰ã„ãªãŒã‚‰æ›¸ãã¾ã—ãŸã€‚
ã‚‚ã£ã¨å®‰å…¨ãªæ›¸ãæ–¹ãŒã‚ã‚Œã°ã€æ•™ãˆã¦ã„ãŸã ã‘ã‚‹ã¨å¬‰ã—ã„ã§ã™ï¼